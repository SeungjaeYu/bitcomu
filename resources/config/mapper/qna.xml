<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.bitcomu.repository.dao.QnaDAO">
	<resultMap type="Qna" id="qnaMap">
		<result column="qna_no" property="qnaNo"/>
		<result column="user_no" property="userNo"/>
		<result column="qna_title" property="qnaTitle" />
		<result column="qna_content" property="qnaContent" />
		<result column="qna_public_enabled" property="qnaPublicEnabled" />
		<result column="qna_like_cnt" property="qnaLikeCnt" />
		<result column="qna_reg_dt" property="qnaRegDt" />
	</resultMap>
	
	<select id="selectQna" parameterType="Page" resultMap="qnaMap">
	   select *
	      from (select rownum rnum, a.*
			      from ( select q.*, (select user_id  from tb_user u where u.user_no = q.user_no ) as user_id 
                            from tb_qna q
						   order by qna_no desc
						  )
						  a)
		 where rnum between #{begin} and #{end}  			 
	</select>
	<select id="selectQnaCount" resultType="int">
		select count(*)
		  from tb_qna
	</select>
	<select id="selectOneQna" parameterType="int" resultMap="qnaMap">
		select q.*, (select user_id  from tb_user u where u.user_no = q.user_no ) as user_id 
                            from tb_qna q
		 where qna_no = #{qnaNo} 
	</select>
	<insert id="insertQna" parameterType="Qna">
		insert into tb_qna (
			qna_no, qna_title, qna_content, user_no
		) values (
			tb_qna_seq.nextval, #{title}, #{content}, ${userNo}
		)
	</insert>
	<update id="updateQna" parameterType="Qna" >
		update tb_qna 
		   set qna_title = #{title}, 
		       qna_content = #{content}
		 where qna_no = #{qnaNo}
	</update>
	<delete id="deleteQna" parameterType="int">
		delete 
		  from tb_qna
		 where qna_no = #{qnaNo}
	</delete>
</mapper>