<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.bitcomu.repository.dao.OnlineclsDAO">


<resultMap type="Onlinecls" id="onlineclsMap">
	<result column="yt_no" property="ytNo" />
	<result column="user_no" property="userNo" />
	<result column="yt_title" property="ytTitle" />
	<result column="yt_content" property="ytContent" />
	<result column="yt_addr" property="ytAddr" />
	<result column="yt_reg_dt" property="ytRegDt" />
	<result column="yt_subject" property="ytSubject" />
	<result column="yt_view_cnt" property="ytViewCnt" />
	<result column="yt_like_cnt" property="ytLike" />
</resultMap>
<!-- 회원번호로 조인해 회원아이디 조회 -->
<select id="selectUserId" parameterType="int" resultType="String" flushCache="true" useCache="true">
	select (select user_id from tb_user u
			 where y.user_no = u.user_no) as user_id
	  from tb_youtube y
	 where yt_no = #{ytNo}
</select>
<!-- 온라인강의 과목 리스트 조회 -->
<select id="selectOnlineclsSubject" resultMap="onlineclsMap" flushCache="true" useCache="true">
	select max(yt_subject) as yt_subject, max(yt_addr) as yt_addr 
	  from tb_youtube 
	 group by yt_subject
</select>
<!-- 온라인강의 리스트 조회 -->	
<select id="seletOnlinecls" resultMap="onlineclsMap" parameterType="string" flushCache="true" useCache="true">
	select * 
	  from tb_youtube
	 where yt_subject = #{ytSubject}
</select>

<!-- 온라인강의 상세 -->	
<select id="selectOneOnlinecls" resultMap="onlineclsMap" parameterType="int" flushCache="true" useCache="true">
	select *
	  from tb_youtube
	 where yt_no = #{ytNo}
</select>

<!-- 온라인강의 추가 -->	
<insert id="insertOnlinecls" parameterType="Onlinecls">
	insert into tb_youtube(
		yt_no, user_no, yt_title, yt_content, yt_addr, yt_subject
	) values (
		tb_youtube_seq.nextval, #{userNo}, #{ytTitle}, #{ytContent}, #{ytAddr}, #{ytSubject} 
	)
</insert>

<!-- 온라인강의 수정 -->	
<update id="updateOnlinecls" parameterType="Onlinecls">
	update tb_youtube
	   set yt_title = #{ytTitle},
	       yt_content = #{ytContent},
	       yt_addr = #{ytAddr}
	 where yt_no = #{ytNo}
</update>

<!-- 온라인강의 삭제 -->	
<delete id="deleteOnlinecls" parameterType="int">
	delete
	  from tb_youtube
	 where yt_no = #{ytNo}
</delete>
</mapper>
<!--
검색은
select * 
  from tb_youtube
 where title = '%' ||#{title}|| '%'
  

 -->